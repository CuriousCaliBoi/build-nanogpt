Input x shape: torch.Size([4, 8, 768])
After c_attn projection shape: torch.Size([4, 8, 2304])
After splitting - q,k,v shapes: torch.Size([4, 8, 768])
After reshaping - q,k,v shapes: torch.Size([4, 12, 8, 64])
Key tensor:
tensor([[[[-2.8594e-01, -1.5397e-01, -1.7441e-04,  ...,  8.1573e-01,
            3.2339e-01,  4.1484e-01],
          [ 5.9249e-01,  6.4030e-01,  3.2949e-01,  ..., -1.1106e+00,
           -5.7862e-01,  3.4882e-01],
          [-5.4643e-01, -5.1333e-01,  9.7164e-02,  ...,  8.7129e-01,
            4.4326e-01,  3.0329e-01],
          ...,
          [-9.5014e-01,  1.4803e-01, -8.0592e-01,  ..., -7.1381e-01,
           -7.3218e-01, -1.8398e-01],
          [-6.9857e-02,  1.7608e-01,  4.3345e-01,  ..., -7.8593e-02,
            1.7514e+00, -4.2897e-01],
          [-5.2713e-01,  3.7074e-01,  6.1161e-01,  ..., -2.5198e-01,
            4.0482e-01, -3.1379e-01]],

         [[-2.6275e-02, -1.9144e-01,  6.8781e-02,  ...,  9.3124e-01,
           -7.2709e-01,  2.2939e-01],
          [-1.0363e+00, -1.6916e-01, -1.6248e-03,  ..., -1.7401e-01,
            4.7501e-01,  1.0754e+00],
          [ 4.3470e-01, -2.4877e-01, -8.7233e-02,  ..., -4.4458e-01,
           -8.1900e-02,  6.2183e-01],
          ...,
          [ 6.8254e-01,  3.2954e-01,  1.0880e+00,  ...,  3.7580e-01,
            9.3025e-02, -4.5020e-01],
          [ 4.6428e-01, -1.4712e-01, -2.0216e-01,  ..., -9.7629e-01,
           -9.9300e-01, -6.6997e-01],
          [-6.1847e-02, -1.9861e-01,  4.2507e-01,  ...,  7.6084e-02,
           -1.5967e-01,  2.1005e-01]],

         [[ 6.4440e-01,  1.2390e+00,  9.8485e-02,  ..., -6.3723e-01,
            1.3031e-01, -3.2779e-01],
          [ 1.8423e-01,  9.5422e-01, -6.5253e-01,  ...,  5.6942e-01,
            2.3700e-01,  2.1419e-01],
          [ 1.7097e-01,  2.3267e-02,  2.7131e-01,  ..., -8.8382e-02,
            6.9625e-02, -4.3920e-01],
          ...,
          [ 3.7984e-01, -8.7406e-01,  1.2245e+00,  ..., -9.8453e-01,
           -2.0663e-01, -2.9683e-01],
          [-2.9276e-01,  4.7749e-01, -5.0015e-01,  ..., -3.0995e-01,
            6.7526e-01,  7.5024e-01],
          [ 2.3122e-01, -6.2475e-01,  3.1872e-01,  ..., -7.5761e-01,
            1.7847e-01,  1.3908e-01]],

         ...,

         [[-1.5158e-01,  9.7515e-02,  8.8663e-03,  ...,  6.1825e-03,
            4.7150e-01,  2.1897e-01],
          [ 1.5659e+00,  6.3145e-01, -7.5676e-02,  ...,  7.1817e-01,
            4.8218e-01, -6.5370e-01],
          [ 9.0983e-01, -5.8012e-01,  3.1989e-01,  ...,  3.4832e-01,
           -1.8573e+00,  1.0552e+00],
          ...,
          [-3.8680e-01, -6.0069e-01, -3.9361e-01,  ...,  2.1609e-03,
           -6.4759e-02, -1.3579e+00],
          [-3.3181e-01,  1.5174e-01,  4.9425e-01,  ...,  3.5532e-01,
            1.1414e+00,  1.8493e-01],
          [-6.5331e-01, -1.9153e-01,  4.6241e-01,  ...,  2.1147e-02,
            9.1992e-01, -4.2778e-01]],

         [[-2.8131e-01,  7.0735e-01,  4.2898e-01,  ..., -9.7971e-01,
            9.5563e-02, -5.0412e-01],
          [ 8.5308e-01,  6.0148e-01,  3.5630e-01,  ..., -8.5787e-02,
            2.3815e-02, -3.0311e-01],
          [ 2.4142e-01,  3.4919e-01,  7.2628e-01,  ...,  1.3503e-02,
            2.3150e-01, -3.8036e-01],
          ...,
          [ 1.3990e-01, -4.5362e-01,  4.7516e-01,  ...,  8.5671e-02,
           -2.9496e-02,  6.2530e-01],
          [ 7.0062e-01, -9.1159e-01, -2.5440e-01,  ...,  3.7354e-01,
            7.9051e-01, -6.8494e-01],
          [ 1.0441e+00, -5.3484e-01,  6.8020e-01,  ..., -3.4209e-01,
           -1.5812e+00,  6.2798e-01]],

         [[ 6.6302e-01,  1.3393e-01, -1.1515e+00,  ...,  1.5384e-01,
           -2.9569e-02,  3.4178e-01],
          [-3.5896e-01, -8.0198e-01, -3.7647e-01,  ...,  7.1810e-01,
            1.7786e-01,  2.0479e-02],
          [ 7.1995e-01, -5.4527e-02,  5.2440e-02,  ...,  1.2277e-01,
           -9.6654e-01,  5.2202e-01],
          ...,
          [ 7.6466e-03, -7.4158e-01,  1.0907e+00,  ...,  3.3742e-01,
            9.7154e-02,  6.7704e-01],
          [ 8.8426e-01, -3.0862e-01, -2.8390e-01,  ..., -8.7714e-01,
            2.4182e-01, -4.3070e-01],
          [ 5.2121e-01, -1.1487e-01, -1.9164e-01,  ...,  2.3443e-01,
           -1.0510e+00, -6.8155e-01]]],


        [[[ 1.1120e+00, -2.4794e-02, -8.4038e-01,  ..., -8.8138e-03,
            5.6963e-01,  5.8270e-01],
          [-1.9064e-01,  4.3560e-01, -4.4876e-02,  ...,  3.0738e-01,
           -3.4276e-01,  1.5921e-01],
          [ 3.3505e-01, -8.9148e-02,  3.3864e-01,  ...,  5.1571e-01,
            4.0322e-03, -7.3173e-01],
          ...,
          [ 2.6008e-01,  5.5521e-01, -3.9793e-01,  ..., -9.2497e-01,
           -1.3507e-01,  6.3979e-01],
          [ 1.3341e-02, -8.4208e-01,  1.6350e-01,  ..., -7.3571e-01,
           -5.2779e-01,  3.7505e-01],
          [-1.0729e-01, -3.4538e-01, -1.8792e-02,  ..., -5.2369e-01,
            5.8339e-01, -2.8828e-01]],

         [[-2.4743e-01, -3.3560e-01,  3.8244e-01,  ..., -8.7261e-01,
            7.9637e-01,  1.6386e-01],
          [ 1.6174e-01,  1.3450e+00, -1.1843e-01,  ...,  5.5317e-01,
           -5.4898e-01,  8.1192e-01],
          [-8.8932e-01,  9.2025e-01, -5.5068e-02,  ...,  4.9134e-01,
            5.5176e-01,  1.2024e-01],
          ...,
          [-9.2861e-02,  4.6487e-01,  1.0218e+00,  ..., -4.5161e-02,
            3.4906e-01, -3.0004e-01],
          [-1.9975e-01, -2.4095e-01,  1.3822e-01,  ...,  6.3756e-01,
            3.7797e-02,  1.6785e-01],
          [ 3.4911e-02,  6.0221e-01,  2.3649e-01,  ..., -4.9466e-01,
           -7.7179e-01,  1.6606e-01]],

         [[ 9.7234e-02, -5.5293e-01,  5.3731e-02,  ..., -4.7015e-01,
            6.0557e-01, -1.2014e+00],
          [-2.5774e-01,  6.4761e-01,  5.4790e-01,  ...,  7.0242e-02,
            5.9795e-01,  5.3869e-01],
          [ 2.4072e-01,  7.8424e-01, -4.2353e-01,  ...,  7.0038e-01,
            4.7989e-01, -6.7111e-01],
          ...,
          [-1.0575e-01, -7.7784e-02, -7.0380e-01,  ..., -1.6456e-01,
           -8.5343e-02, -5.9157e-01],
          [-1.3217e-01, -8.0710e-01,  6.4153e-01,  ...,  1.5109e-01,
           -2.8216e-01,  3.8350e-01],
          [-4.3763e-01, -3.2485e-01, -4.2451e-01,  ...,  9.0670e-01,
           -3.7953e-02,  4.6106e-01]],

         ...,

         [[ 1.9304e+00,  1.9601e-01,  1.1922e+00,  ..., -1.0814e-01,
           -1.3321e-01, -9.3571e-01],
          [ 1.6471e+00, -2.6689e-01, -4.8471e-01,  ..., -1.7306e-01,
           -1.2883e+00,  2.0744e-01],
          [ 1.1226e+00, -1.1533e+00,  1.1456e+00,  ..., -1.8516e-01,
           -8.8729e-02, -1.0960e+00],
          ...,
          [-1.1597e+00,  7.2190e-01, -7.5570e-01,  ...,  9.9175e-01,
            2.0785e-01, -9.1363e-02],
          [-8.5972e-01, -6.7176e-01,  8.1205e-01,  ..., -4.9074e-02,
           -1.3174e-01,  4.8710e-01],
          [-6.4336e-01,  6.9166e-01,  6.2605e-03,  ...,  1.3245e+00,
           -8.4562e-01,  7.5363e-01]],

         [[ 2.8866e-01,  1.5199e-02, -1.2879e+00,  ...,  2.1845e-01,
           -5.2391e-01,  5.4874e-01],
          [-9.3194e-01, -4.6164e-01,  5.0353e-01,  ..., -8.3671e-01,
           -1.8085e-01, -2.7351e-01],
          [ 4.8557e-01, -9.1475e-01,  9.1542e-01,  ..., -3.8663e-01,
           -1.2092e-01, -1.0872e+00],
          ...,
          [-2.9289e-02, -3.0831e-01,  4.3241e-01,  ..., -2.5935e-01,
           -1.4435e-01,  3.9322e-01],
          [ 3.5789e-01, -4.4003e-02, -1.1945e+00,  ...,  5.3699e-01,
           -7.0579e-01,  4.4797e-01],
          [ 4.8605e-01, -8.8101e-01, -4.5943e-01,  ...,  2.9392e-01,
            3.9646e-01,  1.8662e-02]],

         [[-5.1304e-01,  3.1427e-01,  2.2480e-01,  ...,  6.5318e-01,
           -2.2084e-01, -6.1120e-01],
          [ 5.6383e-01, -6.6342e-01, -2.7308e-01,  ..., -3.6833e-01,
            2.5402e-01,  1.9170e-01],
          [-9.1008e-01,  2.4192e-01,  8.6012e-02,  ...,  2.4922e-01,
           -3.6274e-01, -8.5057e-01],
          ...,
          [-2.4128e-01,  3.1317e-01, -3.5470e-01,  ..., -3.2913e-01,
           -6.6472e-01,  6.5637e-01],
          [-1.5364e-01, -6.5438e-02, -1.4834e+00,  ...,  3.6678e-01,
           -2.6465e-01,  2.3875e-01],
          [-3.8193e-01,  4.4731e-01,  3.9606e-01,  ..., -1.2543e+00,
            4.7915e-01,  2.9357e-01]]],


        [[[-6.5085e-01, -4.8997e-01, -8.4178e-01,  ...,  4.2843e-02,
            5.3968e-01,  3.7148e-01],
          [ 1.0401e+00, -2.2853e-01,  6.2616e-01,  ...,  4.6918e-01,
           -4.3478e-01,  4.5655e-01],
          [ 2.0674e-01, -3.5452e-01,  1.1715e+00,  ...,  7.5943e-01,
            1.2607e-02, -5.4232e-01],
          ...,
          [ 1.9979e-01,  1.8936e-01, -4.6011e-01,  ...,  9.2353e-01,
            3.3490e-01, -8.4091e-01],
          [ 2.8096e-01, -6.3175e-01,  8.3835e-01,  ...,  2.4011e-01,
           -3.5559e-01, -2.8495e-01],
          [ 5.6651e-01,  2.8110e-01,  8.3233e-01,  ...,  6.5098e-01,
           -4.6851e-01,  1.2264e-01]],

         [[-1.5658e-01, -4.4290e-01,  1.0907e-01,  ..., -5.3404e-01,
           -6.0721e-01, -1.5140e-01],
          [-1.1546e-01, -4.5339e-01,  5.1676e-01,  ...,  9.0013e-02,
            3.6992e-01, -6.1618e-01],
          [-1.0398e-01, -5.3781e-01, -7.5752e-01,  ..., -1.0127e-01,
           -7.3256e-01, -1.0200e+00],
          ...,
          [-3.0327e-01,  3.4660e-02,  1.3028e-01,  ..., -3.9959e-01,
           -2.3254e-01,  3.7969e-01],
          [ 6.2342e-01, -2.1630e-02, -5.8757e-01,  ...,  4.0992e-01,
           -1.2670e+00, -1.2598e-01],
          [-5.3086e-01,  2.7995e-01, -4.1267e-01,  ..., -2.7175e-02,
           -3.6822e-01,  1.3351e-01]],

         [[-1.1740e-01,  2.3377e-01,  1.2864e-01,  ...,  2.2138e-01,
           -1.1340e+00,  3.5774e-01],
          [ 1.4430e+00, -5.1285e-02,  3.1947e-01,  ..., -5.8351e-01,
           -1.9749e-01, -3.7773e-01],
          [ 1.4473e-01, -7.4176e-01,  7.9511e-01,  ..., -2.2612e-01,
            6.8935e-01, -4.5154e-01],
          ...,
          [ 8.6714e-02,  8.9118e-01, -7.0752e-01,  ...,  5.3474e-01,
            3.7503e-02,  7.3089e-01],
          [-1.7507e-01, -1.3110e-01, -4.1265e-02,  ..., -1.0892e-01,
            3.1415e-01, -3.1288e-01],
          [-3.4478e-02,  5.6614e-01, -7.2891e-02,  ..., -5.0511e-01,
           -7.2151e-02, -4.2363e-01]],

         ...,

         [[ 1.9851e+00,  9.5248e-01,  6.8307e-01,  ..., -1.8626e-01,
           -6.6299e-01, -1.4463e-02],
          [ 3.2787e-01,  2.5069e-01, -1.0652e-01,  ..., -8.6675e-01,
            2.4556e-01,  1.8116e-01],
          [ 5.2299e-01,  2.5194e-01,  6.0092e-01,  ...,  1.9101e-01,
            1.2370e+00,  2.5509e-03],
          ...,
          [-5.2678e-01,  4.0012e-02, -2.5927e-01,  ..., -1.0223e+00,
           -3.6526e-01, -8.0036e-01],
          [ 9.0473e-02, -1.6257e-01,  8.3912e-01,  ..., -1.7929e-01,
            3.3319e-01, -1.0482e-01],
          [ 4.9169e-01, -9.0291e-01, -3.9948e-01,  ..., -7.6907e-01,
            1.7984e-01, -1.0364e+00]],

         [[ 4.6158e-01, -5.0158e-01, -1.7827e-01,  ...,  6.9711e-01,
           -6.4965e-01,  5.0595e-01],
          [-3.8551e-01,  4.3291e-01,  3.1416e-01,  ..., -1.1651e+00,
           -2.6778e-01, -5.2176e-01],
          [-1.5800e-01,  9.9261e-02,  2.2273e-01,  ..., -1.3915e-01,
           -6.3406e-01,  1.0659e-01],
          ...,
          [-3.1065e-01,  8.3188e-02,  7.1774e-01,  ..., -8.2071e-01,
            1.8489e-02, -3.1265e-01],
          [-9.1074e-01, -1.9890e-01,  1.4029e-01,  ...,  6.1642e-01,
           -6.2584e-01, -4.5264e-01],
          [-1.1063e+00, -4.8232e-01,  1.6782e-01,  ..., -5.6131e-01,
           -8.7692e-01,  1.3127e-01]],

         [[-2.1500e-01,  5.3873e-01,  4.4706e-01,  ..., -3.5423e-01,
           -8.4022e-01, -2.5320e-01],
          [ 5.8325e-01, -1.1083e+00,  4.4239e-01,  ...,  3.1167e-01,
            1.4241e-01, -3.7778e-01],
          [-8.5786e-01,  1.3451e-01, -3.4807e-01,  ...,  4.8034e-01,
            6.5638e-01, -1.0728e+00],
          ...,
          [-6.1205e-01, -2.3547e-01,  1.3260e-01,  ..., -4.9737e-01,
            4.7909e-01,  7.1019e-01],
          [-2.9690e-01, -1.2982e+00, -5.6830e-01,  ..., -5.2147e-01,
            1.7842e-01, -1.2460e-01],
          [-2.1765e-01, -6.4456e-01,  8.9234e-01,  ...,  8.8317e-01,
           -8.1091e-01,  1.8219e-01]]],


        [[[-1.1179e+00, -2.7743e-01,  1.7148e-02,  ...,  2.5889e-01,
            5.6947e-01, -3.1596e-01],
          [ 3.1344e-01, -2.2280e-01, -5.3986e-01,  ..., -3.6359e-01,
            3.2886e-02,  5.9674e-01],
          [ 1.1274e+00,  7.8924e-01, -1.1124e+00,  ...,  1.2468e+00,
            3.3038e-01,  7.2846e-01],
          ...,
          [-9.2260e-01,  3.0493e-01,  9.5251e-02,  ..., -5.8728e-01,
            2.2273e-01,  7.1484e-01],
          [ 6.6843e-01, -2.9102e-01,  8.3426e-01,  ..., -7.2465e-01,
            1.0533e-01,  6.1793e-01],
          [-5.0434e-01, -6.6221e-01,  3.2203e-02,  ...,  1.2222e-01,
           -7.8785e-01,  3.9596e-02]],

         [[-1.1436e-01, -8.6644e-01, -7.1478e-01,  ..., -1.1709e-01,
            5.4419e-01,  4.5523e-01],
          [ 2.3947e-01,  1.1369e-01,  2.3516e-01,  ...,  1.4344e-01,
            2.1769e-01, -1.7365e-01],
          [-6.0806e-01,  2.4703e-01,  3.9950e-01,  ..., -5.7978e-01,
           -1.1890e+00, -6.1942e-02],
          ...,
          [ 2.1886e-01, -2.7002e-01,  1.2496e+00,  ..., -5.9578e-02,
           -9.0847e-01,  1.2836e+00],
          [ 1.0835e+00,  1.3678e-01,  8.5827e-01,  ..., -1.0868e-01,
            3.6805e-01,  5.5702e-01],
          [-6.5398e-01, -8.4401e-01,  3.4052e-01,  ..., -6.1240e-01,
            2.7383e-01, -4.3518e-01]],

         [[ 1.1280e-01, -2.7939e-01, -1.2663e+00,  ..., -9.5083e-02,
           -2.8422e-01, -1.2680e-01],
          [-7.4692e-02,  2.9701e-01, -2.2545e-01,  ..., -3.9751e-01,
           -1.2727e+00,  2.1424e-01],
          [-6.9651e-01,  1.0820e-01, -2.0222e-01,  ...,  5.7898e-01,
           -3.5102e-01,  2.3039e-01],
          ...,
          [-8.0155e-01,  3.5914e-01,  6.8751e-01,  ..., -9.0492e-02,
           -3.1720e-01, -4.9374e-01],
          [ 4.9989e-01,  7.7165e-01, -1.0857e+00,  ..., -4.7612e-01,
           -6.0047e-02, -8.4898e-02],
          [ 4.2594e-02, -4.3454e-01,  6.7159e-01,  ..., -1.7391e-02,
           -4.8383e-01,  2.9311e-01]],

         ...,

         [[ 1.0526e+00, -1.0286e+00,  6.8221e-01,  ..., -2.4999e-01,
            3.1428e-01,  7.0672e-01],
          [-4.4607e-01, -2.9401e-01, -8.7820e-01,  ..., -8.7375e-01,
            2.3875e-01,  8.2366e-01],
          [ 4.8086e-01, -4.1743e-01, -6.2667e-01,  ..., -2.7034e-01,
            6.1532e-02,  4.1720e-01],
          ...,
          [ 2.7870e-01,  1.6095e-01,  1.1222e-01,  ...,  9.2129e-01,
           -6.6256e-02, -2.8711e-01],
          [-3.5911e-01,  1.7925e-01,  1.6035e-01,  ...,  5.9405e-01,
           -7.1785e-02, -7.5648e-01],
          [ 1.1157e-01, -4.7986e-01,  5.0512e-01,  ..., -1.4117e+00,
           -3.4043e-01,  1.0030e+00]],

         [[-2.6236e-01,  4.5378e-01, -7.1994e-01,  ...,  9.2966e-02,
            2.1804e-01,  6.9996e-01],
          [-1.3577e-01,  5.2519e-01, -7.6498e-01,  ...,  6.4503e-01,
           -3.8567e-01,  6.3581e-01],
          [-6.4195e-01,  1.8351e-01, -2.9830e-01,  ...,  5.7971e-01,
           -3.1590e-01, -8.8311e-01],
          ...,
          [ 5.2914e-01, -9.7925e-02,  7.4217e-02,  ...,  8.3718e-01,
           -8.6464e-01,  1.1741e+00],
          [ 3.4657e-01,  5.5403e-01, -2.8189e-02,  ...,  4.6833e-01,
            3.1592e-03, -1.8045e-01],
          [ 4.1814e-01,  1.6213e+00,  6.8110e-01,  ...,  3.6219e-01,
           -2.6781e-01,  7.1759e-01]],

         [[-6.4949e-01,  1.9740e-01,  3.5811e-01,  ..., -6.8046e-01,
           -6.4673e-01,  3.1726e-01],
          [ 3.2150e-01, -1.3427e+00,  7.7180e-01,  ...,  4.6838e-01,
           -4.8479e-01, -5.4776e-01],
          [ 5.8649e-01,  1.7286e-01, -5.1781e-01,  ..., -9.6011e-01,
           -7.5490e-01, -2.0986e-01],
          ...,
          [ 2.5169e-01,  2.9450e-02, -4.4676e-01,  ..., -1.2452e-01,
           -3.3578e-01,  2.0251e-01],
          [ 2.3134e-01,  6.0883e-01, -1.3263e-01,  ..., -8.1997e-01,
           -2.9127e-01,  7.9554e-01],
          [-9.5349e-01,  5.6281e-01,  7.0762e-01,  ...,  1.7555e-01,
            7.9353e-03,  5.2791e-01]]]], grad_fn=<TransposeBackward0>)
Query tensor:
tensor([[[[ 2.5654e-01, -1.6990e-01,  8.7604e-02,  ...,  3.3811e-01,
            1.2979e+00,  3.0058e-01],
          [ 1.5506e-01, -9.2746e-02, -1.9918e-01,  ...,  2.4888e-01,
            6.5591e-01, -1.0138e-01],
          [ 5.8677e-01, -1.6589e-01, -3.3934e-01,  ..., -4.7654e-02,
           -3.0826e-01,  9.6872e-01],
          ...,
          [-7.3365e-01,  9.7357e-02, -3.7118e-01,  ...,  3.7322e-01,
            6.5108e-01,  5.3821e-02],
          [ 2.2524e-01,  2.9929e-01,  3.3672e-01,  ..., -7.1493e-01,
           -2.8748e-01, -1.0844e+00],
          [-2.9198e-01,  1.0123e+00, -4.9730e-01,  ..., -1.0168e+00,
            3.6422e-01, -7.2847e-01]],

         [[ 8.8299e-01,  1.9194e-01, -5.6225e-01,  ...,  9.3183e-01,
            1.8921e-01,  3.7220e-01],
          [-1.2798e-01,  8.2167e-02, -1.4350e-01,  ...,  5.7691e-01,
           -1.4756e+00, -1.0491e+00],
          [-7.4573e-01,  1.2894e+00, -1.9153e-01,  ...,  2.3790e-01,
            4.0489e-01, -3.0999e-01],
          ...,
          [ 3.8616e-01, -2.8177e-01, -6.1838e-01,  ...,  5.0963e-02,
            8.7458e-02, -2.9951e-01],
          [-1.7332e-01,  1.1041e+00,  4.2797e-01,  ...,  4.2614e-01,
            7.8759e-01, -2.4774e-01],
          [-3.7903e-01,  1.6204e-01,  1.6328e-01,  ..., -3.7191e-02,
            9.6614e-01,  9.0379e-01]],

         [[ 1.3616e-01,  4.4129e-01,  8.6602e-01,  ...,  2.3347e-01,
           -1.6394e-01,  4.7970e-01],
          [-1.8093e-01, -6.7237e-01, -3.9031e-01,  ..., -2.1737e-01,
           -5.9801e-01, -5.8343e-01],
          [ 6.5020e-01,  1.8430e-01,  4.0154e-01,  ..., -1.7337e-01,
            1.0313e-01, -1.1462e-02],
          ...,
          [-4.0565e-01,  3.5837e-01, -5.3122e-01,  ...,  9.1756e-01,
            3.9678e-01,  8.7230e-01],
          [ 3.8426e-01,  7.3669e-02,  3.7534e-01,  ..., -8.7986e-01,
           -6.9217e-01, -1.2826e-01],
          [-1.1321e+00, -7.9591e-01, -8.9939e-02,  ..., -2.7280e-01,
            3.6619e-01,  5.9802e-01]],

         ...,

         [[-7.5639e-02, -2.1587e-01, -1.2194e+00,  ..., -1.5650e-01,
            6.1852e-01,  4.9709e-01],
          [ 6.3682e-01,  2.0061e-01,  6.7049e-01,  ..., -7.8232e-01,
            4.2316e-01, -7.4822e-01],
          [ 3.1617e-01,  5.1866e-01,  2.3548e-01,  ..., -4.4263e-01,
           -3.1793e-01, -1.1550e-01],
          ...,
          [ 4.3894e-01,  5.0117e-01,  8.1495e-01,  ...,  9.3712e-01,
            3.1140e-01,  6.6360e-01],
          [-9.5599e-01, -4.0360e-01,  3.7196e-01,  ..., -6.9792e-01,
           -5.4852e-01, -2.2891e-03],
          [ 1.3561e-01, -1.3621e-01, -2.9238e-01,  ..., -1.3631e+00,
            5.3154e-01,  6.9159e-01]],

         [[-5.4628e-01, -7.1658e-01,  9.0882e-04,  ...,  4.2106e-01,
           -4.5053e-01, -4.6647e-01],
          [-5.6567e-01,  8.3776e-01,  1.6236e-02,  ...,  3.8667e-01,
            9.9505e-01,  3.9308e-01],
          [-2.0988e-01,  4.0931e-01, -9.2240e-01,  ...,  3.2585e-01,
           -7.9552e-01,  1.5104e-01],
          ...,
          [ 5.1781e-01,  4.1580e-01, -5.7752e-02,  ...,  3.4063e-01,
           -1.8477e-01, -8.0045e-02],
          [-1.8819e-02, -1.2109e-01, -2.7490e-02,  ..., -2.8336e-01,
            9.3846e-01, -7.3368e-01],
          [-3.6059e-01,  2.3066e-01, -1.6213e-01,  ..., -9.0280e-01,
            5.0298e-02,  2.4707e-01]],

         [[-7.5201e-01,  3.5942e-01,  7.7558e-01,  ...,  4.7798e-01,
            5.2263e-01,  5.0147e-01],
          [-4.5832e-01,  1.1252e+00, -8.8126e-01,  ..., -3.3178e-01,
           -8.4042e-02, -7.0170e-02],
          [-5.7551e-01, -3.1253e-01,  2.7781e-01,  ..., -5.5305e-01,
           -6.7700e-01, -2.4297e-01],
          ...,
          [-1.6144e-01, -2.2715e-01, -8.7554e-02,  ...,  9.2850e-01,
           -1.1267e-01, -6.6395e-02],
          [ 5.1087e-01,  1.5109e-02,  3.9438e-01,  ...,  3.7105e-02,
            4.7059e-01,  4.9281e-01],
          [-2.6489e-01,  5.3815e-01,  1.0496e+00,  ...,  4.5076e-01,
            1.0542e+00,  7.0712e-01]]],


        [[[ 7.4127e-01,  4.6901e-01,  2.0697e-01,  ...,  6.4692e-01,
            7.6614e-02, -1.2653e-01],
          [-1.9592e-01, -2.4697e-02,  7.9382e-02,  ...,  7.8969e-01,
            5.2928e-01, -6.3200e-01],
          [ 2.1835e-01,  4.3274e-01, -5.6193e-01,  ..., -1.7133e-01,
            2.1602e-01,  1.1360e+00],
          ...,
          [ 2.6292e-01,  8.6329e-02, -4.3193e-01,  ..., -3.3937e-02,
            1.1168e+00,  4.8607e-01],
          [-4.6578e-01,  3.1967e-02, -4.7534e-01,  ..., -7.6809e-01,
            1.0521e+00, -8.4510e-01],
          [-3.1323e-01, -1.3590e-01,  3.7736e-01,  ..., -6.6212e-01,
            1.2751e+00, -5.4817e-01]],

         [[ 4.6614e-01, -9.2815e-02, -1.7934e-02,  ...,  3.4575e-01,
           -1.9762e-01, -4.7462e-03],
          [-5.1428e-01, -2.6853e-01,  2.5881e-01,  ...,  2.2970e-04,
            7.5879e-01,  4.0362e-01],
          [-1.3943e-01, -5.6542e-01, -1.6367e-01,  ..., -4.1769e-01,
           -3.5728e-01,  9.0309e-01],
          ...,
          [ 4.9687e-01,  5.2661e-01,  4.2755e-01,  ...,  6.4238e-01,
           -2.8441e-02, -4.8565e-01],
          [ 7.2294e-01,  3.5037e-01,  2.1127e-01,  ..., -2.5674e-01,
            5.3853e-03,  3.8898e-01],
          [-5.2463e-01,  2.1576e-01,  5.2808e-01,  ...,  2.6272e-01,
            8.5957e-01, -8.5721e-02]],

         [[-4.2753e-01,  1.9048e-01,  9.6985e-01,  ..., -8.0470e-01,
           -1.9868e-01,  2.7045e-01],
          [-5.3788e-01,  5.2778e-02, -5.3418e-01,  ..., -4.0729e-01,
            3.2258e-01, -6.2421e-01],
          [-1.7339e-01,  8.1484e-01,  2.2278e-01,  ...,  1.4661e-02,
            3.1993e-01,  7.0031e-02],
          ...,
          [ 3.4815e-01, -8.9915e-01, -3.8260e-01,  ..., -9.5628e-01,
           -3.9608e-01,  2.2345e-01],
          [ 6.6469e-01,  1.9579e-01,  3.0748e-01,  ..., -5.2558e-02,
            8.5744e-01, -2.4728e-01],
          [-3.1467e-01,  1.7902e-01, -1.1982e+00,  ...,  1.4013e+00,
           -2.6301e-01, -1.3522e+00]],

         ...,

         [[-7.7649e-02,  4.3136e-01, -1.3248e-01,  ..., -3.4080e-01,
            6.8986e-01,  4.2272e-01],
          [-3.3254e-01,  3.0847e-02, -6.5074e-01,  ..., -6.8839e-01,
           -4.9110e-02,  9.5198e-01],
          [ 6.6692e-01, -1.5558e-01, -1.1317e-01,  ..., -3.6085e-01,
           -2.8543e-01,  4.2158e-01],
          ...,
          [-2.6628e-01,  1.2391e-02,  5.9920e-01,  ...,  4.8850e-02,
           -7.6664e-01, -5.8423e-01],
          [-6.9753e-03,  8.9298e-01,  4.9032e-01,  ...,  1.0898e+00,
           -5.1295e-01,  6.9372e-01],
          [-7.9803e-02,  1.0309e+00,  1.2038e+00,  ..., -3.4439e-01,
           -4.7700e-01, -4.5515e-01]],

         [[ 4.7577e-01,  4.6028e-02, -9.9769e-03,  ..., -5.1230e-01,
            4.0427e-01,  1.4103e-01],
          [-2.4405e-01, -1.6322e+00, -1.4608e+00,  ..., -7.9992e-03,
           -4.2309e-01, -2.4007e-01],
          [ 1.0636e+00, -2.2277e-01,  4.4139e-01,  ..., -3.7176e-01,
           -6.3432e-01,  2.6320e-01],
          ...,
          [ 4.1163e-01,  1.0692e-01, -1.6059e-01,  ..., -1.0979e-01,
           -5.8609e-01,  6.6070e-01],
          [ 8.5454e-01,  1.5333e+00,  3.0446e-01,  ...,  4.2828e-01,
            8.6160e-01, -6.2710e-01],
          [-5.5359e-01,  6.2327e-01,  2.4782e-01,  ...,  4.4463e-01,
            2.3772e-02, -9.6519e-02]],

         [[ 3.7661e-01, -5.8927e-02,  3.3520e-01,  ...,  1.1930e+00,
           -1.3843e+00, -3.8994e-01],
          [ 4.6355e-01,  1.5302e-01,  4.2744e-01,  ...,  3.8243e-01,
           -1.7907e-01, -7.5487e-01],
          [-7.0315e-02,  1.5037e-01, -5.0849e-01,  ..., -3.8546e-01,
           -2.7218e-03, -6.2323e-01],
          ...,
          [ 1.1131e-01, -9.8467e-01,  3.8007e-01,  ..., -8.5305e-01,
           -3.3531e-01,  2.1022e-01],
          [ 7.5308e-01,  3.2056e-01,  5.6580e-01,  ..., -6.1465e-01,
           -2.3664e-01,  6.5313e-02],
          [ 4.4804e-01, -4.3245e-02, -2.2408e-02,  ..., -3.0677e-01,
            5.0591e-01, -2.5045e-01]]],


        [[[-2.5363e-01,  6.3050e-01,  1.1728e+00,  ...,  2.0385e-01,
           -5.0373e-01,  2.3694e-01],
          [ 4.6743e-01,  8.7460e-01,  1.7894e-01,  ..., -6.6614e-01,
            9.2114e-02, -6.3506e-01],
          [-2.2699e-01, -1.3531e-01,  2.9172e-02,  ..., -5.1000e-01,
           -7.8086e-01,  6.2139e-01],
          ...,
          [ 5.4849e-01, -1.9051e-01, -1.0060e+00,  ...,  1.0424e-02,
           -1.6049e-01, -4.6774e-01],
          [ 4.0998e-01,  1.8897e-01, -1.3171e-01,  ...,  5.6540e-01,
           -2.1999e-01, -4.2859e-01],
          [ 8.9570e-02,  3.2756e-01,  4.2455e-01,  ...,  8.4178e-01,
            6.9133e-01, -1.1171e-01]],

         [[-8.0285e-02, -8.5184e-01,  2.7420e-01,  ...,  1.0185e+00,
            3.7338e-01, -5.3334e-01],
          [-3.1492e-01,  2.7776e-01,  1.0137e+00,  ...,  4.2531e-02,
            7.8274e-01,  1.3562e+00],
          [ 2.6531e-01,  8.2830e-01,  1.8082e-01,  ...,  1.8623e+00,
            6.6502e-01,  4.8884e-01],
          ...,
          [-1.0135e+00, -7.9374e-01,  1.0411e-01,  ...,  3.6815e-01,
           -4.4172e-01,  8.0115e-01],
          [ 1.8560e-01, -3.2290e-01, -1.0592e+00,  ...,  6.0609e-02,
            1.0315e+00, -1.2265e+00],
          [ 3.3512e-01, -1.4305e-01, -4.0196e-01,  ..., -4.1213e-01,
            1.1208e+00, -3.4776e-01]],

         [[-8.1435e-01, -2.8383e-01, -1.6123e-01,  ..., -2.2878e-01,
           -4.7878e-01, -7.2845e-03],
          [ 1.5228e-01,  5.2990e-01, -6.1068e-01,  ..., -6.4052e-01,
           -6.3851e-01,  4.7882e-01],
          [ 6.4009e-01, -2.2575e-01,  1.7412e-01,  ...,  8.4020e-02,
           -4.4670e-01, -1.1491e-01],
          ...,
          [-4.3533e-01, -3.8684e-01,  1.9149e-01,  ..., -4.3038e-02,
            1.3421e+00, -8.5611e-01],
          [ 2.7425e-01, -1.3936e-01,  1.7968e+00,  ...,  2.4199e-02,
            1.0161e-01,  4.6621e-01],
          [-3.1502e-01,  3.2628e-01, -7.3963e-01,  ..., -1.9245e-01,
           -4.1574e-01,  7.7518e-01]],

         ...,

         [[-2.2519e-01,  1.0156e+00, -1.6479e-01,  ...,  1.7247e-01,
            1.3811e-01,  3.7628e-01],
          [ 1.9931e-01,  1.5703e+00,  7.8282e-02,  ...,  6.2529e-01,
            4.1876e-02, -1.8061e-01],
          [-1.8823e-01,  1.7048e-01, -8.6254e-01,  ..., -2.6733e-04,
            9.0039e-04, -1.8838e-02],
          ...,
          [-5.8681e-01,  5.3747e-01,  1.0097e+00,  ...,  9.7324e-01,
           -3.0994e-01, -8.4070e-02],
          [ 6.4050e-01,  2.5085e-01,  1.0477e-01,  ...,  5.1845e-01,
            1.9516e-01, -4.9442e-01],
          [-5.2427e-01, -3.6563e-01, -3.1100e-01,  ...,  1.0661e+00,
           -6.6858e-01,  2.7949e-02]],

         [[-1.3225e-01, -1.2756e+00,  2.3388e-02,  ...,  4.4670e-01,
           -2.6708e-01, -1.3933e-01],
          [-4.8216e-01, -7.5852e-01, -5.8117e-01,  ...,  7.6474e-01,
            7.6111e-01, -2.7500e-01],
          [ 8.9102e-01, -9.4936e-01,  2.2193e-02,  ..., -7.1291e-02,
           -3.3467e-01, -6.7670e-01],
          ...,
          [ 2.1440e-01, -9.0412e-01,  7.5103e-02,  ...,  1.4416e+00,
            2.5193e-01,  8.6684e-01],
          [-6.1981e-01,  2.4214e-01, -5.2670e-01,  ...,  6.0364e-01,
            6.1013e-02,  6.3012e-01],
          [-5.7916e-01, -1.4064e-01, -6.6909e-02,  ..., -3.5962e-01,
           -2.7763e-01, -9.3459e-02]],

         [[ 7.4192e-01, -2.0255e-01,  7.7470e-01,  ..., -7.5694e-01,
           -6.8462e-01, -8.1622e-01],
          [-2.6535e-01,  1.0273e-01,  5.1577e-01,  ..., -1.8705e-01,
            9.8363e-01,  2.7960e-01],
          [ 1.3949e-01, -5.3504e-01, -2.0738e-02,  ..., -1.1542e-01,
           -5.1060e-01, -7.5419e-01],
          ...,
          [-2.0561e-01,  1.3697e+00,  6.4061e-02,  ...,  1.2663e-01,
           -4.5853e-02,  3.8408e-01],
          [ 2.8357e-01, -4.3736e-01, -1.1851e-01,  ..., -2.7065e-01,
           -5.2752e-01,  6.2044e-01],
          [ 7.4006e-02,  5.8591e-01,  3.2029e-01,  ..., -8.1576e-01,
           -3.4698e-02, -6.8018e-01]]],


        [[[-5.6022e-01, -5.8848e-01, -1.6206e-01,  ..., -7.7085e-01,
           -7.5965e-02, -1.8472e-01],
          [-7.5537e-01, -1.6628e-01,  1.0192e-01,  ...,  2.2994e-01,
            3.1456e-01, -6.1931e-01],
          [-5.7665e-01,  6.7203e-01, -1.6273e-01,  ...,  1.0789e-01,
            3.8802e-01,  1.4001e-01],
          ...,
          [ 2.6788e-01, -1.2794e-01,  4.6576e-01,  ...,  4.1311e-01,
           -8.6594e-02, -8.1655e-01],
          [ 7.3264e-01,  6.4505e-01,  2.2722e-01,  ..., -4.1131e-01,
            2.8372e-01, -1.4762e-01],
          [ 3.3705e-01,  1.0082e+00, -1.5117e+00,  ...,  1.2254e+00,
            2.3457e-01,  2.4889e-01]],

         [[ 2.5130e-01, -4.8056e-01,  4.8779e-01,  ..., -4.3820e-01,
           -4.9833e-01,  5.5992e-01],
          [ 2.0420e-01,  2.8563e-01, -1.6061e+00,  ...,  1.1581e+00,
           -1.3175e-03, -3.3868e-01],
          [ 4.8408e-01,  1.0294e+00, -1.2030e+00,  ..., -7.6469e-01,
           -2.0177e-01, -9.4613e-01],
          ...,
          [-5.5122e-01,  1.3160e+00,  5.6601e-02,  ..., -2.8729e-01,
            1.1470e+00, -2.7856e-02],
          [ 1.3156e-01,  4.3158e-01,  6.0298e-01,  ..., -4.3100e-01,
            7.6362e-01, -1.2394e+00],
          [-7.1413e-01,  1.6098e+00,  1.3877e-01,  ...,  3.6559e-01,
           -5.6409e-01, -1.2076e-01]],

         [[ 9.2068e-01,  1.0590e-01, -9.2576e-01,  ...,  1.1797e+00,
           -8.9033e-01,  2.2778e-03],
          [ 1.0994e-01,  1.1634e-01, -4.3369e-01,  ...,  7.8354e-01,
           -2.2658e-01,  5.7751e-01],
          [ 5.2335e-01, -1.4414e-01,  2.9192e-02,  ...,  6.1808e-01,
            3.2037e-02,  3.1657e-01],
          ...,
          [-5.2418e-01, -5.7835e-01, -1.3502e+00,  ..., -2.6486e-01,
           -6.8768e-02, -5.2842e-01],
          [-1.6442e+00,  7.8456e-01,  4.2195e-01,  ...,  3.4813e-01,
            1.2453e-01,  1.2289e+00],
          [ 7.6695e-02,  3.0635e-01, -5.1722e-01,  ...,  4.5478e-01,
            2.8099e-01, -5.9346e-01]],

         ...,

         [[-1.0395e-01, -2.1332e-01,  1.1882e-01,  ..., -3.9727e-01,
            6.6528e-01,  5.5818e-01],
          [ 2.3499e-02,  9.5571e-01, -3.6674e-01,  ..., -1.7841e-01,
            6.3760e-01,  2.5245e-01],
          [ 2.6303e-02, -3.6018e-01, -8.9471e-01,  ...,  1.3829e-01,
           -3.4793e-01, -3.1358e-01],
          ...,
          [ 4.6955e-02,  7.0348e-01, -8.1864e-02,  ..., -5.5386e-02,
            6.1248e-01,  2.0515e-01],
          [-1.2407e-01, -3.9413e-01,  5.6062e-01,  ..., -5.4170e-01,
            2.5407e-01, -4.9720e-01],
          [ 3.6967e-01, -4.3154e-01, -6.7311e-02,  ...,  1.5874e+00,
            7.0330e-01,  3.5481e-02]],

         [[ 3.4625e-01, -8.7224e-02, -4.8607e-01,  ...,  6.1827e-01,
           -7.8464e-01,  1.0467e+00],
          [-8.0801e-01, -1.1336e+00,  1.2580e-01,  ...,  2.5644e-01,
            1.7689e-01,  4.2657e-01],
          [-2.3220e-01,  1.1234e-01,  2.0527e+00,  ..., -1.9736e-01,
           -6.2985e-01, -1.8736e-01],
          ...,
          [ 5.6610e-01,  3.7656e-01, -4.4888e-01,  ..., -3.1419e-01,
            5.8565e-01, -1.0023e-01],
          [ 7.1385e-01,  2.6839e-01,  2.8729e-01,  ..., -8.8289e-02,
           -1.0803e-02,  7.2864e-01],
          [-6.1617e-01,  1.9243e+00,  2.3211e-01,  ...,  7.0407e-01,
           -8.2185e-01,  3.4209e-01]],

         [[ 1.1195e+00, -3.4241e-01, -2.1964e-01,  ...,  3.7600e-01,
           -4.5881e-02, -4.8317e-01],
          [ 1.1847e+00,  4.3545e-01,  1.0412e+00,  ...,  1.6334e-01,
           -3.4154e-01, -3.7514e-01],
          [ 9.2699e-02, -4.0025e-01,  1.6114e-01,  ..., -2.0118e+00,
           -4.2771e-01, -1.9034e-02],
          ...,
          [ 4.6816e-01,  3.6644e-01, -3.6592e-01,  ..., -2.4478e-01,
           -1.3979e+00,  1.2034e+00],
          [ 1.6343e-01,  8.6665e-02, -3.9806e-01,  ...,  2.7991e-01,
           -1.5214e+00, -1.7913e-01],
          [-2.6656e-01,  1.8697e+00,  3.6623e-02,  ..., -2.8781e-01,
            3.9927e-01,  6.0473e-01]]]], grad_fn=<TransposeBackward0>)
Value tensor:
tensor([[[[-0.2266,  0.1046, -0.2816,  ...,  0.4010,  1.0590,  0.4371],
          [-1.6543,  0.6416, -0.8338,  ...,  0.3879, -0.2724, -0.3890],
          [-0.3002,  0.1527, -0.2417,  ...,  0.2536,  1.2013, -0.3507],
          ...,
          [ 0.1456, -1.0860, -0.0299,  ...,  0.5624,  0.0371, -0.0499],
          [-0.2893,  0.5802, -0.2591,  ...,  0.1590,  0.0836,  0.1880],
          [-0.3565, -0.9715, -0.4550,  ...,  1.2236, -0.5245, -0.8718]],

         [[-1.1677,  0.3711, -0.2895,  ...,  0.9723,  1.0944,  0.7144],
          [ 0.4848,  0.1501,  0.1466,  ..., -0.4779, -1.0161, -0.0883],
          [ 0.5041,  1.0603, -0.2007,  ...,  1.0378, -0.2204, -0.3087],
          ...,
          [ 0.8308,  0.4579,  0.3305,  ...,  1.3155,  0.8412, -0.3405],
          [ 0.8446,  0.0589, -0.2979,  ..., -0.4453, -0.9313, -0.4870],
          [ 0.2224,  1.1332,  0.1479,  ...,  1.6311, -0.4105,  0.6603]],

         [[-0.2317, -1.1785,  0.4432,  ..., -0.1848, -0.7366, -0.0489],
          [ 0.0972,  0.1689, -0.4774,  ...,  1.2732,  0.4272, -0.5905],
          [ 0.5092, -0.3290, -0.1826,  ..., -1.0751,  0.5719,  0.2310],
          ...,
          [ 0.6337,  0.5188,  0.0590,  ..., -0.1989, -0.2445,  0.1923],
          [ 1.0538, -0.4059, -0.1171,  ...,  0.4759, -0.2903, -0.9684],
          [ 0.2886,  0.1024, -0.0339,  ..., -0.5742,  0.2132,  1.1242]],

         ...,

         [[ 0.2687, -0.7163,  0.6379,  ...,  0.6575,  0.9676, -0.1901],
          [-0.0921, -0.0173, -0.0810,  ..., -0.5106,  0.1100,  1.1387],
          [ 0.5946,  0.5628, -0.3543,  ...,  1.1506, -0.9210,  1.0482],
          ...,
          [-0.1886,  0.8058,  0.1437,  ...,  0.6384,  0.5724, -1.0032],
          [ 0.6229, -0.7477,  0.8117,  ..., -0.2945,  0.4439,  0.0553],
          [ 0.1629, -0.1976, -0.7324,  ..., -0.2202, -0.4642, -0.9921]],

         [[ 0.6764, -0.7563,  0.0795,  ...,  0.1684,  0.1298, -1.4838],
          [ 0.6214,  0.5842, -0.5448,  ...,  0.3220,  0.4492, -0.4377],
          [-0.2983, -0.3898,  0.3736,  ...,  0.2054,  0.8623,  0.9245],
          ...,
          [-0.3771,  0.4707, -0.7877,  ...,  0.0300, -0.1959, -0.9125],
          [-0.3066, -0.7082,  0.5214,  ..., -0.7009,  0.1191,  0.3536],
          [-0.0585, -0.3592, -0.0192,  ...,  1.6960, -0.9664, -0.0056]],

         [[-0.1546,  0.3192,  0.0075,  ...,  0.7903,  0.1849, -0.4529],
          [-0.0218, -0.0387, -0.5286,  ..., -0.1801, -0.5789,  0.0139],
          [ 0.7612,  0.8131, -0.5012,  ...,  0.0552, -0.0672, -1.2591],
          ...,
          [ 0.0132,  0.3811,  0.0966,  ...,  0.1005, -0.2517, -0.2359],
          [-1.2743, -0.3090,  1.0225,  ..., -0.1365,  0.3375,  0.2353],
          [-0.8055,  0.5265, -0.1179,  ..., -0.5312,  0.1677, -0.1994]]],


        [[[ 0.1312, -0.3797, -0.2515,  ...,  0.1789,  1.1106, -0.7290],
          [-0.2358,  0.2982, -0.4545,  ...,  0.1163,  0.2736,  0.3597],
          [-0.1870,  0.2972, -0.6665,  ..., -0.0693, -0.5189, -0.1379],
          ...,
          [-0.4232,  0.0735,  0.3578,  ..., -0.1502, -0.2659,  0.9114],
          [-0.7381, -0.4048, -0.0269,  ..., -0.0366, -0.1511, -0.0443],
          [-0.0046,  0.0186,  0.7459,  ...,  0.1568,  0.9015,  0.3460]],

         [[ 0.5196, -0.2042, -0.1104,  ...,  0.2948, -0.3328, -0.0312],
          [-0.4472,  0.2083, -0.7134,  ...,  0.0404,  0.3099,  0.2306],
          [ 0.2170,  0.6696, -0.7734,  ..., -0.1960,  0.0773,  0.2513],
          ...,
          [ 0.4130, -0.4120,  0.7947,  ..., -1.1519,  0.6486,  0.7231],
          [ 0.4160, -1.2803, -0.2455,  ...,  0.6916,  0.2684, -0.0171],
          [ 0.1724,  0.2651, -0.9041,  ..., -0.3972,  0.6136,  0.3671]],

         [[ 0.1355,  0.1802,  0.1800,  ...,  1.3068, -0.4642,  0.4070],
          [ 1.1490, -0.1825, -0.4228,  ...,  0.4525,  0.0145, -0.1648],
          [-0.3215,  0.5305,  0.5940,  ...,  0.1182,  0.2940, -0.2882],
          ...,
          [ 0.1787, -0.1925,  0.1904,  ...,  0.0879, -0.6244,  0.7185],
          [ 0.8953,  0.7048, -0.3694,  ...,  0.3868, -0.1650, -0.3767],
          [-1.1195, -0.2434, -0.6338,  ..., -0.2482,  0.0201,  0.7420]],

         ...,

         [[-1.0047, -0.3110, -0.0142,  ...,  0.6615,  1.1327, -0.6259],
          [-0.2047,  1.0277,  0.6740,  ..., -0.2271,  1.0725, -0.2258],
          [-0.8674,  0.6383,  0.2706,  ...,  0.7604,  0.2314,  0.3235],
          ...,
          [ 0.2916, -0.1497,  0.1420,  ...,  0.2371,  0.0657,  0.3290],
          [-0.1368, -0.4417, -0.1997,  ..., -0.2438,  0.7670, -0.1816],
          [ 0.8180, -0.0677, -1.0992,  ..., -0.2940,  0.4485,  0.1817]],

         [[ 0.0485,  0.9698, -0.4418,  ...,  0.0273, -0.0116, -0.6813],
          [-0.8387, -0.7524,  0.2008,  ..., -0.5206,  0.2645,  0.4111],
          [ 0.2455,  0.4715, -0.0438,  ..., -0.6596, -0.2014,  0.0752],
          ...,
          [-0.1351, -0.1314,  0.8067,  ...,  0.4997,  0.2010, -0.6228],
          [-0.3428,  0.7344, -0.0378,  ..., -0.5170,  0.3990, -0.0970],
          [ 0.2062,  0.4342,  0.1732,  ...,  1.5418,  0.5228,  0.4983]],

         [[-0.1594,  0.1484,  0.7591,  ...,  0.9106,  0.5124,  0.6177],
          [ 0.6349, -0.4819, -0.7530,  ..., -0.3099,  0.5213,  0.0361],
          [-0.8361,  0.2726,  0.0497,  ...,  0.2376,  0.2841,  0.4783],
          ...,
          [-0.3383, -0.9660,  0.6423,  ...,  0.2042,  0.3747,  0.6497],
          [-0.2712, -0.7840, -0.9767,  ..., -0.7716, -0.3396, -0.2455],
          [ 1.4416, -0.6242,  0.3915,  ...,  1.0496, -0.2185, -0.8041]]],


        [[[ 0.3748,  0.1142,  1.0042,  ...,  1.1512,  1.0630,  0.5447],
          [-0.2481, -0.1118, -1.7268,  ..., -0.8810,  0.4314, -0.1063],
          [-0.0968, -0.1575,  0.5693,  ..., -0.1447, -1.2461,  0.9737],
          ...,
          [-0.9829, -0.6710, -0.9898,  ...,  0.0144, -0.6162,  0.2834],
          [-0.4797,  0.6936, -0.9733,  ...,  0.1612, -0.2037,  0.5853],
          [ 1.1108,  0.0457, -0.4207,  ..., -0.8789,  0.8421,  0.2282]],

         [[ 0.5162,  1.0171, -0.3858,  ..., -0.6292, -0.7072,  0.1045],
          [-1.3512, -1.5716,  0.3873,  ...,  1.0035, -0.0146, -0.4280],
          [-0.5798,  1.3559, -0.0510,  ..., -0.0295,  0.8812,  0.4468],
          ...,
          [-0.0181, -0.2871,  0.4300,  ...,  0.7755, -0.6018, -0.3961],
          [-0.5451,  0.3458, -0.4944,  ..., -0.5099,  0.4121, -0.9016],
          [ 0.5092,  0.0559,  0.7518,  ...,  0.0877,  0.3459, -0.0214]],

         [[ 0.0500,  0.3298,  0.4781,  ..., -0.8394, -0.3043,  0.1395],
          [ 0.4005, -0.8110,  0.7425,  ...,  0.4294, -0.3900,  0.8024],
          [-0.5958,  0.2662,  0.3395,  ..., -0.7941,  0.0740, -0.4315],
          ...,
          [-0.6657, -0.3633,  0.1651,  ..., -0.3842, -0.3448,  0.0288],
          [-0.6611,  0.1470,  0.5833,  ...,  0.2621,  0.6544, -0.1802],
          [-0.1238,  0.0954,  0.5893,  ...,  0.7953, -0.7816,  0.4557]],

         ...,

         [[-0.1205, -0.2098, -0.0063,  ..., -0.3045,  0.4311, -0.4316],
          [-0.6438,  0.0993,  0.4044,  ..., -0.1345, -0.1190,  0.2182],
          [ 1.0952, -0.7349,  0.2269,  ..., -0.4505, -0.7198,  0.1437],
          ...,
          [-0.4257,  0.4217,  0.0121,  ..., -1.2270, -0.0323, -0.5145],
          [ 0.4048,  0.2429, -0.2519,  ..., -0.3593, -0.0259,  0.0792],
          [ 0.0159, -0.4109, -0.1938,  ..., -0.1394,  0.1258, -0.9047]],

         [[-0.3450, -0.3704,  0.0935,  ...,  0.4630, -0.6453, -0.5970],
          [ 0.3001, -0.9827,  0.4527,  ..., -0.5050,  0.2869, -0.2528],
          [ 0.1845, -0.0831, -0.4719,  ..., -0.8842,  0.2067, -0.0095],
          ...,
          [-0.2863, -0.0840,  0.5143,  ..., -0.0865,  0.0699,  0.7105],
          [ 0.8279, -0.3863,  1.0563,  ..., -0.4767,  0.6453, -0.8060],
          [ 0.6956, -0.6561,  0.0753,  ..., -0.1311, -0.6402,  1.0695]],

         [[ 0.8136,  1.0700, -0.5175,  ..., -0.1716,  0.8757,  0.1830],
          [ 0.7727, -0.8277,  0.6447,  ..., -0.5892,  0.2451,  0.0341],
          [-0.0379, -0.1524, -0.1048,  ...,  0.6938,  0.6127, -0.2063],
          ...,
          [ 0.0426,  0.2339, -1.0474,  ...,  0.5058,  0.0108, -0.5053],
          [ 0.5623,  0.5257, -0.5247,  ...,  0.1124,  0.0202,  0.5148],
          [-0.2760, -0.0815,  0.8241,  ..., -0.1531,  0.5782, -0.2237]]],


        [[[ 0.7936, -0.0618,  0.5363,  ..., -0.4234,  1.0614,  0.5829],
          [ 0.4677,  0.1446,  0.0592,  ..., -0.5663,  0.0701,  1.1942],
          [-0.4654, -0.6217,  0.3334,  ...,  0.6244, -0.7555, -0.2908],
          ...,
          [ 0.3392,  1.1182, -0.7047,  ...,  0.5106, -0.4795,  0.0257],
          [ 0.5782, -0.3155, -0.4645,  ..., -0.0596,  0.8756,  0.5263],
          [-0.3580,  0.3081, -0.1995,  ..., -0.5510, -0.2224, -0.8169]],

         [[-0.0473,  0.0716,  0.5197,  ...,  0.1144,  0.5976, -0.9714],
          [-0.2411,  1.2159, -0.9675,  ...,  0.4921, -0.2496,  0.4007],
          [-1.0622,  0.1829,  0.2139,  ...,  0.2259, -0.0429, -0.3969],
          ...,
          [-0.2166,  0.5565, -0.8326,  ...,  0.3768,  0.0470, -0.4962],
          [ 0.3005,  0.0780, -0.4905,  ...,  0.5832,  0.5079, -0.1589],
          [-1.1884, -0.0666,  0.6738,  ...,  0.5199, -0.6534,  0.2530]],

         [[ 0.0169,  0.0796,  0.4041,  ...,  0.9143, -0.9861,  0.3840],
          [-1.0210,  0.6923,  0.1124,  ...,  0.1852, -0.0211,  0.0863],
          [-0.3737, -0.2817, -0.2716,  ...,  0.7756, -0.9573, -0.6037],
          ...,
          [ 0.5181,  0.6924, -0.3630,  ...,  0.7205,  0.3016, -0.0208],
          [ 0.4728, -0.4926, -0.2264,  ...,  0.3197,  0.1976, -1.0213],
          [-1.3057,  0.0720,  1.2296,  ...,  0.1860, -0.7533,  1.7134]],

         ...,

         [[-0.2989,  0.7660, -0.1008,  ..., -0.0907, -0.5340, -0.3129],
          [-0.4305, -0.2942,  0.1449,  ...,  0.4274, -0.4097, -0.3936],
          [ 0.1130, -0.1494,  0.3425,  ..., -0.1632,  0.3309, -0.5851],
          ...,
          [ 0.3857, -0.5010,  0.6615,  ..., -0.5093,  0.5077, -0.7198],
          [-1.0720, -0.7148,  0.1542,  ...,  0.2718, -0.5815, -0.1308],
          [-0.2620,  0.2083, -0.2432,  ..., -0.2228,  0.5069, -0.0038]],

         [[-0.3727,  0.2261,  0.1997,  ...,  0.3129,  0.8682,  0.1996],
          [-0.8635, -0.4690,  1.1024,  ...,  0.3403, -0.5934,  0.2765],
          [-0.5363,  0.6233, -0.3027,  ...,  1.0654,  0.9822, -0.0762],
          ...,
          [ 0.3977, -0.2953,  0.3422,  ...,  0.1787,  1.1200,  0.2547],
          [-0.5408,  0.1661,  0.2723,  ..., -0.2520, -0.4720, -0.4811],
          [ 0.2135, -0.9630,  0.1918,  ...,  0.4904, -0.3499, -0.6805]],

         [[ 0.5704,  0.7464, -0.7492,  ..., -0.2983, -0.3719,  0.9984],
          [ 0.1759, -1.2993,  0.0359,  ..., -0.4042,  0.8089,  0.1424],
          [-0.7460,  0.2129,  0.3530,  ..., -0.2755, -0.0890,  0.0240],
          ...,
          [-0.4985,  0.6144, -0.6770,  ...,  0.5928,  0.0206, -0.1457],
          [ 0.0393,  0.5265,  0.0525,  ...,  0.6543, -0.6764,  0.1785],
          [ 0.2008, -0.6238,  0.0540,  ...,  0.2024,  0.3446, -0.0986]]]],
       grad_fn=<TransposeBackward0>)
After attention shape: torch.Size([4, 12, 8, 64])
Attention tensor: I want to see the different heads before we reshape back
tensor([[[[-2.2663e-01,  1.0460e-01, -2.8163e-01,  ...,  4.0096e-01,
            1.0590e+00,  4.3712e-01],
          [-8.5848e-01,  3.4226e-01, -5.2600e-01,  ...,  3.9520e-01,
            4.6975e-01,  7.1508e-02],
          [-1.0690e+00,  4.2582e-01, -5.9274e-01,  ...,  3.6184e-01,
            3.1864e-01, -2.1005e-01],
          ...,
          [-4.6018e-02, -1.9599e-01, -1.8934e-01,  ...,  2.1253e-01,
            4.6165e-01,  1.0110e-01],
          [-1.7148e-01,  3.9450e-02, -1.3948e-01,  ...,  2.3190e-01,
            9.7222e-02,  1.1647e-01],
          [-1.4523e-01, -6.4558e-02, -1.6306e-01,  ...,  3.0699e-01,
            9.3951e-02,  1.9336e-02]],

         [[-1.1677e+00,  3.7107e-01, -2.8949e-01,  ...,  9.7234e-01,
            1.0944e+00,  7.1437e-01],
          [-3.9515e-01,  2.6776e-01, -8.5622e-02,  ...,  2.9436e-01,
            1.0779e-01,  3.3914e-01],
          [-1.2907e-01,  3.7010e-01, -6.8653e-02,  ...,  2.9244e-01,
           -1.0810e-01,  1.7801e-01],
          ...,
          [ 3.7720e-03,  3.8988e-01, -5.5866e-02,  ...,  7.9648e-01,
            3.9212e-01, -7.4264e-02],
          [ 2.2751e-01,  2.0086e-01, -5.8229e-02,  ...,  6.0540e-01,
            2.6443e-02, -1.9422e-01],
          [ 1.0736e-01,  2.8790e-01, -3.9360e-02,  ...,  7.0974e-01,
           -1.1053e-01,  2.4348e-03]],

         [[-2.3171e-01, -1.1785e+00,  4.4319e-01,  ..., -1.8478e-01,
           -7.3657e-01, -4.8945e-02],
          [-9.7471e-02, -6.2867e-01,  6.7518e-02,  ...,  4.1018e-01,
           -2.6166e-01, -2.6994e-01],
          [ 1.2157e-01, -4.1451e-01, -9.2975e-02,  ...,  7.6380e-02,
            1.0294e-01, -1.6183e-01],
          ...,
          [ 2.4102e-01, -3.0439e-01,  9.3711e-02,  ...,  4.3636e-02,
           -1.4142e-02,  2.8352e-03],
          [ 4.3584e-01, -1.7338e-01,  3.9742e-02,  ..., -3.8428e-02,
           -2.9881e-02, -1.2635e-01],
          [ 4.2418e-01, -2.0556e-01,  6.3877e-02,  ...,  1.2024e-01,
           -9.9940e-02, -8.6022e-02]],

         ...,

         [[ 2.6868e-01, -7.1629e-01,  6.3793e-01,  ...,  6.5745e-01,
            9.6765e-01, -1.9013e-01],
          [ 7.9362e-02, -3.4951e-01,  2.6070e-01,  ...,  4.4536e-02,
            5.1763e-01,  5.0713e-01],
          [ 2.9757e-01,  2.2837e-02,  1.2316e-02,  ...,  5.1704e-01,
           -7.2087e-02,  7.1836e-01],
          ...,
          [-2.9625e-02,  1.0453e-01,  1.6173e-01,  ...,  5.1535e-01,
           -3.3008e-04,  2.4921e-01],
          [ 8.3238e-02, -5.2608e-02,  3.2327e-01,  ...,  4.4714e-01,
            2.1980e-01,  3.4731e-03],
          [ 2.4196e-02, -2.7032e-02,  2.1082e-01,  ...,  4.0215e-01,
            2.0328e-01, -1.9162e-01]],

         [[ 6.7641e-01, -7.5627e-01,  7.9525e-02,  ...,  1.6836e-01,
            1.2977e-01, -1.4838e+00],
          [ 6.5109e-01, -1.3987e-01, -2.0755e-01,  ...,  2.3903e-01,
            2.7665e-01, -1.0027e+00],
          [ 3.0744e-01, -1.6676e-01, -2.8063e-02,  ...,  2.3418e-01,
            5.0203e-01, -2.6129e-01],
          ...,
          [ 6.0551e-02,  1.4206e-01, -2.7191e-01,  ...,  1.0062e-01,
            2.6240e-01, -3.4142e-01],
          [-7.2447e-02,  4.3226e-03, -1.7941e-01,  ..., -3.9633e-02,
            2.6298e-01, -2.0669e-01],
          [-1.4596e-02, -7.9828e-02, -1.1895e-01,  ...,  1.9150e-01,
            4.1000e-02, -2.6711e-01]],

         [[-1.5465e-01,  3.1916e-01,  7.4591e-03,  ...,  7.9034e-01,
            1.8490e-01, -4.5287e-01],
          [-8.4480e-02,  1.3014e-01, -2.7572e-01,  ...,  2.7773e-01,
           -2.1857e-01, -2.0630e-01],
          [ 1.9764e-01,  4.2116e-01, -2.8294e-01,  ...,  3.3055e-01,
           -6.1098e-02, -6.4338e-01],
          ...,
          [ 2.6013e-01,  1.7042e-01, -3.6727e-01,  ...,  2.3291e-01,
           -5.3858e-02, -4.1043e-01],
          [ 6.8847e-02,  1.6542e-01, -8.3249e-02,  ...,  1.3216e-01,
            3.3634e-02, -3.5472e-01],
          [-1.4294e-01,  1.5570e-01, -2.9676e-02,  ...,  6.9194e-02,
            5.4770e-02, -2.7733e-01]]],


        [[[ 1.3122e-01, -3.7966e-01, -2.5149e-01,  ...,  1.7890e-01,
            1.1106e+00, -7.2900e-01],
          [-5.8885e-02, -2.8549e-02, -3.5665e-01,  ...,  1.4648e-01,
            6.7705e-01, -1.6511e-01],
          [-2.2567e-02, -7.1244e-02, -4.0199e-01,  ...,  9.9573e-02,
            5.1242e-01, -3.6946e-01],
          ...,
          [-3.0422e-01, -7.2279e-02, -3.0002e-01,  ..., -2.5701e-01,
            2.8951e-01, -4.3269e-02],
          [-3.4145e-01, -1.5601e-01, -1.4685e-01,  ..., -1.8414e-01,
            2.2228e-01,  6.7521e-02],
          [-3.2871e-01, -9.6476e-02, -6.4135e-02,  ..., -1.3762e-01,
            2.1671e-01,  4.8846e-02]],

         [[ 5.1960e-01, -2.0420e-01, -1.1039e-01,  ...,  2.9481e-01,
           -3.3282e-01, -3.1227e-02],
          [ 1.6235e-01, -5.1778e-02, -3.3321e-01,  ...,  2.0082e-01,
           -9.5329e-02,  6.5532e-02],
          [ 2.1473e-01,  2.2501e-01, -4.9108e-01,  ...,  4.9422e-02,
           -4.6197e-02,  1.3192e-01],
          ...,
          [ 1.0399e-01,  7.3773e-02, -2.1798e-01,  ..., -1.1627e-01,
            4.0384e-01,  2.6663e-01],
          [ 1.3743e-01, -7.7126e-02, -2.4855e-01,  ...,  1.0813e-02,
            2.5521e-01,  2.0233e-01],
          [ 1.9255e-01, -2.0221e-01, -2.9882e-01,  ..., -1.5457e-02,
            3.7036e-01,  2.2818e-01]],

         [[ 1.3551e-01,  1.8024e-01,  1.8001e-01,  ...,  1.3068e+00,
           -4.6420e-01,  4.0697e-01],
          [ 5.5341e-01,  3.0649e-02, -6.8549e-02,  ...,  9.5452e-01,
           -2.6682e-01,  1.7120e-01],
          [ 3.6400e-01,  1.5046e-01,  8.3722e-02,  ...,  6.7565e-01,
           -8.4882e-02,  1.2529e-02],
          ...,
          [-2.1703e-02,  1.2034e-01,  3.0436e-01,  ...,  3.9762e-01,
           -1.4654e-01,  3.4296e-01],
          [ 7.7251e-02,  2.0099e-01,  2.6049e-01,  ...,  4.0874e-01,
           -5.7484e-02,  1.8275e-01],
          [-2.3121e-01,  1.8653e-01,  1.7045e-01,  ...,  1.8120e-01,
            3.7015e-03,  2.3465e-01]],

         ...,

         [[-1.0047e+00, -3.1104e-01, -1.4194e-02,  ...,  6.6148e-01,
            1.1327e+00, -6.2593e-01],
          [-4.9392e-01,  5.4362e-01,  4.2520e-01,  ...,  9.4166e-02,
            1.0943e+00, -3.7049e-01],
          [-6.7644e-01,  4.3449e-01,  3.1364e-01,  ...,  3.6546e-01,
            8.6500e-01, -2.2155e-01],
          ...,
          [-5.1448e-01, -3.3531e-03,  1.1908e-01,  ...,  4.1498e-01,
            5.6330e-01,  3.0127e-02],
          [-4.8752e-01, -2.9042e-05,  1.5219e-01,  ...,  3.9195e-01,
            5.3118e-01,  5.3653e-02],
          [-4.7116e-01,  9.7330e-02,  9.5747e-02,  ...,  3.6370e-01,
            5.6099e-01,  3.8603e-02]],

         [[ 4.8500e-02,  9.6982e-01, -4.4179e-01,  ...,  2.7262e-02,
           -1.1597e-02, -6.8128e-01],
          [-3.1002e-01,  2.7389e-01, -1.8213e-01,  ..., -1.9413e-01,
            9.9958e-02, -2.3986e-01],
          [-1.5410e-01,  2.6687e-01, -1.0494e-01,  ..., -3.8214e-01,
            6.2377e-03, -8.0516e-02],
          ...,
          [ 5.2375e-02,  3.3065e-01,  1.6912e-01,  ..., -6.3734e-02,
            3.0119e-01, -1.6383e-01],
          [ 3.4745e-02,  3.6399e-01,  1.7246e-01,  ..., -1.9642e-01,
            3.5481e-01, -3.9581e-02],
          [-1.9821e-02,  3.3898e-01,  1.5657e-01,  ...,  1.4775e-02,
            3.5978e-01,  4.1914e-02]],

         [[-1.5936e-01,  1.4842e-01,  7.5915e-01,  ...,  9.1059e-01,
            5.1243e-01,  6.1765e-01],
          [ 2.2810e-01, -1.5909e-01,  2.1442e-02,  ...,  3.1518e-01,
            5.1675e-01,  3.3396e-01],
          [-1.8316e-01,  1.4581e-02,  6.5505e-02,  ...,  3.1361e-01,
            4.3052e-01,  4.0027e-01],
          ...,
          [-3.1917e-02,  9.3960e-02,  1.6982e-01,  ...,  1.7519e-01,
            7.2351e-02,  4.9379e-01],
          [-3.7604e-02,  1.7741e-02, -1.0266e-01,  ..., -2.4337e-03,
            6.0808e-02,  3.4004e-01],
          [ 3.0767e-01, -1.3061e-01,  9.6516e-02,  ...,  2.9472e-01,
           -4.8254e-02,  8.6857e-02]]],


        [[[ 3.7478e-01,  1.1421e-01,  1.0042e+00,  ...,  1.1512e+00,
            1.0630e+00,  5.4471e-01],
          [ 4.4752e-02, -5.5399e-03, -4.4286e-01,  ...,  7.4395e-02,
            7.2838e-01,  1.9974e-01],
          [-2.6652e-02, -5.8686e-02, -3.1371e-01,  ..., -9.2841e-02,
            1.6007e-01,  3.7481e-01],
          ...,
          [-1.1390e-01, -2.6361e-01, -5.9778e-02,  ...,  1.5956e-01,
            4.5773e-02,  3.7129e-01],
          [-2.0106e-01, -1.2210e-01, -1.8803e-01,  ...,  1.2539e-01,
            4.8084e-02,  4.0154e-01],
          [-4.1652e-02, -7.6668e-02, -2.0065e-01,  ...,  1.0169e-03,
            2.3105e-02,  4.3954e-01]],

         [[ 5.1622e-01,  1.0171e+00, -3.8578e-01,  ..., -6.2924e-01,
           -7.0724e-01,  1.0450e-01],
          [-5.9188e-02,  2.1946e-01, -1.4757e-01,  ..., -1.2614e-01,
           -4.9381e-01, -5.9589e-02],
          [-6.1461e-01,  1.5860e-02,  4.6105e-02,  ...,  2.5018e-01,
            7.2461e-02, -1.8384e-02],
          ...,
          [-4.9518e-01, -4.9544e-02,  2.8205e-01,  ...,  3.5830e-01,
           -4.0818e-01,  2.0392e-03],
          [-4.6693e-01,  1.9734e-01,  1.1906e-01,  ...,  1.7229e-01,
           -1.7262e-01, -4.4251e-02],
          [-3.6218e-01,  9.7053e-03,  2.1358e-01,  ...,  1.6562e-01,
           -2.8534e-01, -1.1974e-01]],

         [[ 5.0040e-02,  3.2981e-01,  4.7812e-01,  ..., -8.3941e-01,
           -3.0435e-01,  1.3949e-01],
          [ 2.6791e-01, -3.7930e-01,  6.4249e-01,  ..., -5.0720e-02,
           -3.5762e-01,  5.5158e-01],
          [-6.9773e-02, -1.4031e-02,  5.0586e-01,  ..., -4.6560e-01,
           -2.0037e-01,  1.3332e-01],
          ...,
          [-1.6143e-01, -1.9633e-03,  7.2283e-02,  ..., -2.2949e-01,
           -7.2656e-02,  1.6108e-02],
          [-3.0691e-01, -1.4060e-02,  1.2945e-01,  ..., -1.4092e-01,
            1.2941e-01, -3.8201e-02],
          [-1.8432e-01,  3.9837e-02,  2.3792e-01,  ...,  8.8163e-02,
           -1.8910e-01,  8.8930e-02]],

         ...,

         [[-1.2052e-01, -2.0981e-01, -6.2888e-03,  ..., -3.0447e-01,
            4.3107e-01, -4.3160e-01],
          [-2.7632e-01, -1.1778e-01,  1.1598e-01,  ..., -2.5386e-01,
            2.6731e-01, -2.3814e-01],
          [ 1.9295e-01, -3.1480e-01,  2.4084e-01,  ..., -3.0295e-01,
           -2.4825e-01,  4.5148e-02],
          ...,
          [ 8.2327e-02, -1.9831e-01, -2.5023e-03,  ..., -1.6416e-01,
           -7.1432e-02, -3.0981e-01],
          [ 1.4636e-01, -6.0025e-02,  7.2666e-03,  ..., -2.5430e-01,
           -8.0813e-02, -1.4621e-01],
          [ 1.5315e-01, -2.3384e-01, -7.7487e-02,  ..., -1.8202e-01,
           -1.2293e-01, -3.3233e-01]],

         [[-3.4504e-01, -3.7036e-01,  9.3453e-02,  ...,  4.6296e-01,
           -6.4526e-01, -5.9703e-01],
          [ 6.5278e-02, -7.5983e-01,  3.2196e-01,  ..., -1.5275e-01,
           -5.2352e-02, -3.7809e-01],
          [ 6.8474e-02, -5.1349e-01,  5.2163e-02,  ..., -3.3198e-01,
           -2.0346e-02, -2.8012e-01],
          ...,
          [-4.3781e-02, -1.7914e-01, -7.1253e-02,  ..., -1.8218e-01,
           -1.8831e-02, -1.2074e-01],
          [ 8.3920e-02, -1.7873e-01,  8.1403e-02,  ..., -1.3669e-01,
            5.7369e-02, -2.6696e-01],
          [ 2.1623e-01, -2.6889e-01,  7.6932e-02,  ..., -2.3767e-01,
            4.7116e-02, -4.5834e-02]],

         [[ 8.1364e-01,  1.0700e+00, -5.1748e-01,  ..., -1.7163e-01,
            8.7572e-01,  1.8297e-01],
          [ 7.8513e-01, -2.5022e-01,  2.9109e-01,  ..., -4.6213e-01,
            4.3701e-01,  7.9406e-02],
          [ 5.6180e-01,  9.0386e-02, -1.1451e-02,  ..., -7.0026e-02,
            5.9024e-01,  2.4100e-02],
          ...,
          [ 4.6960e-01,  1.9821e-01,  4.0927e-02,  ..., -1.6866e-01,
            4.0139e-02, -3.7304e-01],
          [ 4.8813e-01,  2.2456e-01,  1.1489e-01,  ..., -2.0319e-01,
            6.6025e-02, -2.5413e-01],
          [ 4.6215e-01,  1.3653e-01,  1.0813e-01,  ..., -1.5448e-01,
            1.8334e-01, -1.9445e-01]]],


        [[[ 7.9361e-01, -6.1847e-02,  5.3632e-01,  ..., -4.2336e-01,
            1.0614e+00,  5.8292e-01],
          [ 6.6489e-01,  1.9711e-02,  3.4788e-01,  ..., -4.7981e-01,
            6.6983e-01,  8.2436e-01],
          [ 2.2729e-01, -2.3953e-01,  3.5545e-01,  ..., -3.9458e-02,
            1.3419e-01,  3.6661e-01],
          ...,
          [ 2.7777e-01,  1.8900e-01,  1.1256e-01,  ..., -7.7554e-02,
           -4.3012e-02,  4.5132e-01],
          [ 3.2194e-01,  1.9551e-01,  2.5007e-02,  ..., -2.9594e-02,
            3.8611e-02,  4.0489e-01],
          [ 1.6077e-01,  8.7811e-02,  6.5065e-02,  ..., -7.1136e-02,
           -4.4633e-02,  1.9487e-01]],

         [[-4.7288e-02,  7.1632e-02,  5.1975e-01,  ...,  1.1437e-01,
            5.9759e-01, -9.7135e-01],
          [-1.2943e-01,  5.5653e-01, -1.1049e-01,  ...,  2.7444e-01,
            2.3859e-01, -3.8991e-01],
          [-4.4814e-01,  4.3081e-01, -2.1402e-03,  ...,  2.5847e-01,
            1.4116e-01, -3.9010e-01],
          ...,
          [-3.0031e-01,  4.3952e-01, -4.9118e-01,  ...,  1.8620e-01,
           -3.9040e-02,  1.0324e-01],
          [-1.9991e-01,  2.7896e-01, -4.2967e-01,  ...,  2.1394e-01,
            8.6311e-02,  4.4817e-02],
          [-2.5043e-01,  2.9994e-01, -3.7275e-01,  ...,  1.9604e-01,
            2.0936e-02,  1.0953e-01]],

         [[ 1.6950e-02,  7.9602e-02,  4.0414e-01,  ...,  9.1434e-01,
           -9.8612e-01,  3.8404e-01],
          [-4.7462e-01,  3.6979e-01,  2.6596e-01,  ...,  5.6900e-01,
           -5.2909e-01,  2.4301e-01],
          [-4.2676e-01,  6.8270e-02,  1.8146e-02,  ...,  6.6527e-01,
           -7.2798e-01, -1.4751e-01],
          ...,
          [-2.5003e-01,  2.3795e-01, -6.9493e-02,  ...,  6.5015e-01,
           -2.7026e-01,  6.9893e-02],
          [-3.7766e-02,  1.1848e-01, -2.9220e-01,  ...,  7.9268e-01,
           -1.6169e-01, -1.9291e-02],
          [-2.1897e-01,  1.1431e-01,  6.9716e-02,  ...,  5.7399e-01,
           -2.5465e-01,  1.5391e-01]],

         ...,

         [[-2.9892e-01,  7.6601e-01, -1.0075e-01,  ..., -9.0738e-02,
           -5.3399e-01, -3.1290e-01],
          [-4.0423e-01, -8.2817e-02,  9.5920e-02,  ...,  3.2412e-01,
           -4.3448e-01, -3.7751e-01],
          [-1.8159e-01,  8.1635e-02,  1.4679e-01,  ...,  4.3652e-02,
           -1.6218e-01, -4.4295e-01],
          ...,
          [ 2.0240e-01, -2.4787e-01,  3.8373e-01,  ..., -1.9296e-01,
           -1.0685e-02, -1.0440e-01],
          [-1.5147e-02, -3.3272e-01,  3.2580e-01,  ..., -5.9088e-02,
            8.4094e-03, -1.0609e-01],
          [ 6.7830e-02, -2.2411e-01,  2.9394e-01,  ..., -1.8177e-01,
            1.6719e-01, -1.5031e-01]],

         [[-3.7275e-01,  2.2608e-01,  1.9971e-01,  ...,  3.1286e-01,
            8.6816e-01,  1.9962e-01],
          [-6.4801e-01, -1.6380e-01,  7.0604e-01,  ...,  3.2825e-01,
            4.8373e-02,  2.4275e-01],
          [-6.0411e-01,  1.9202e-01,  2.5023e-01,  ...,  6.7292e-01,
            4.5976e-01,  9.5125e-02],
          ...,
          [-1.8585e-01,  6.0172e-03,  2.4176e-01,  ...,  5.3380e-02,
            6.3208e-01, -4.8443e-02],
          [-3.2626e-01,  1.7383e-02,  2.6459e-01,  ...,  6.9489e-02,
            3.8249e-01, -5.6895e-02],
          [-1.9028e-01, -1.2936e-01,  2.5920e-01,  ...,  1.1700e-01,
            3.3778e-01, -1.5013e-01]],

         [[ 5.7041e-01,  7.4643e-01, -7.4915e-01,  ..., -2.9828e-01,
           -3.7192e-01,  9.9841e-01],
          [ 2.9182e-01, -6.9828e-01, -1.9473e-01,  ..., -3.7306e-01,
            4.6201e-01,  3.9387e-01],
          [-7.1457e-02,  8.1352e-02, -1.1410e-01,  ..., -3.1138e-01,
            1.3919e-03,  4.0219e-01],
          ...,
          [-1.3005e-01,  1.2947e-01, -6.4336e-02,  ..., -3.6248e-03,
           -1.7051e-02,  1.2291e-01],
          [-5.2070e-02,  6.1876e-02, -1.8668e-02,  ...,  7.7146e-02,
           -6.0347e-02,  7.9903e-02],
          [-4.5988e-02,  1.2407e-01, -5.2746e-02,  ...,  1.0402e-01,
           -8.7227e-02,  1.2286e-01]]]],
       grad_fn=<ScaledDotProductFlashAttentionForCpuBackward0>)
After reshaping back: torch.Size([4, 8, 768])
Final output shape: torch.Size([4, 8, 768])
Input shape: torch.Size([4, 8, 768])
Output shape: torch.Size([4, 8, 768])
